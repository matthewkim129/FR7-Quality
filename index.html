<!DOCTYPE html>
<html lang="ko" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FR7 일일 품질개선 보고</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .thin-scroll::-webkit-scrollbar{width:8px;height:8px}
    .thin-scroll::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:6px}
    .thin-scroll::-webkit-scrollbar-track{background:transparent}
    .drag-over{outline:2px dashed #60a5fa; outline-offset:4px}
    table.calendar {border-collapse: collapse; width: 100%;}
    table.calendar th, table.calendar td {border: 1px solid #e2e8f0; text-align: center; padding: 4px; font-size: 12px;}
    table.calendar td.marked {background-color:#bfdbfe; font-weight:bold;}
  </style>
</head>
<body class="h-full bg-slate-50 text-slate-900">
  <div id="app" class="h-full flex">
    <!-- Sidebar: Report List + Controls -->
    <aside class="w-80 bg-white border-r border-slate-200 flex flex-col">
      <div class="p-4 border-b flex items-center justify-between">
        <h1 class="text-lg font-bold">FR7 일일 보고</h1>
      </div>
      <div class="p-3 border-b space-y-2">
        <button id="newReportBtn" class="w-full py-2 rounded-xl bg-blue-600 text-white font-semibold hover:bg-blue-700">+ 새 보고서</button>
        <button id="printBtn" class="w-full py-2 rounded-xl bg-slate-700 text-white text-sm hover:bg-slate-800">인쇄 / PDF</button>
      </div>

      <div id="reportList" class="flex-1 overflow-y-auto thin-scroll divide-y"></div>
      <div class="p-3 border-t">
        <h2 class="text-sm font-semibold mb-2">달력</h2>
        <div id="calendarContainer"></div>
      </div>
      <div class="p-3 text-xs text-slate-400 border-t">
        로컬 저장소(LocalStorage/IndexedDB)에 저장됩니다.
      </div>
    </aside>

    <!-- Main: Editor -->
    <main class="flex-1 overflow-hidden">
      <!-- Top bar -->
      <div class="px-5 py-3 bg-white border-b flex items-center gap-3">
        <input id="reportTitle" class="text-lg font-bold flex-1 outline-none bg-transparent" placeholder="보고서 제목 (예: 2025-08-27 FR7 품질개선 일일 보고)" />
        <div id="autosaveState" class="text-xs text-slate-500">저장 상태: -</div>
      </div>

      <!-- Tabs: 요약 / 세부 -->
      <div class="px-5 pt-4 bg-white border-b">
        <div class="flex gap-2 text-sm">
          <button data-tab="tab-summary" class="tab-btn px-3 py-2 rounded-t bg-slate-100 font-semibold">요약</button>
          <button data-tab="tab-detail" class="tab-btn px-3 py-2 rounded-t">세부</button>
        </div>
      </div>

      <!-- 요약 -->
      <section id="tab-summary" class="tab-pane p-5 overflow-y-auto thin-scroll h-[calc(100vh-136px)]">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
          <div class="bg-white rounded-xl shadow p-4">
            <h2 class="font-semibold mb-3">기본 정보</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
              <label class="space-y-1">
                <span class="text-slate-600">보고 날짜 (KST)</span>
                <input id="dateKST" type="text" class="w-full rounded border p-2" />
              </label>
              <label class="space-y-1">
                <span class="text-slate-600">프로젝트</span>
                <input id="project" type="text" class="w-full rounded border p-2" placeholder="예: WSOP SC Cyprus 2025"/>
              </label>
              <label class="space-y-1 md:col-span-2">
                <span class="text-slate-600">촬영 장소/환경</span>
                <input id="location" type="text" class="w-full rounded border p-2" placeholder="예: 피처테이블 존, 실내 3200K 조명"/>
              </label>
              <label class="space-y-1">
                <span class="text-slate-600">담당자</span>
                <input id="operator" type="text" class="w-full rounded border p-2" placeholder="예: Trey"/>
              </label>
              <label class="space-y-1">
                <span class="text-slate-600">카메라/렌즈</span>
                <input id="gear" type="text" class="w-full rounded border p-2" placeholder="예: Sony FR7 + 28–135mm F4, 펌웨어 vX.Y"/>
              </label>
            </div>
          </div>

          <div class="bg-white rounded-xl shadow p-4">
            <h2 class="font-semibold mb-3">체크리스트 (QC: 품질관리)</h2>
            <div class="grid grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-2 text-sm" id="qcList"></div>
          </div>

          <div class="bg-white rounded-xl shadow p-4 md:col-span-2">
            <h2 class="font-semibold mb-3">오늘의 요약</h2>
            <textarea id="summary" class="w-full min-h-32 rounded border p-3 text-sm" placeholder="핵심 목표, 주요 변경점, 결과 개요를 간단히 정리"></textarea>
          </div>
        </div>
      </section>

      <!-- 세부: 과정, 결과·측정, 캡처, 영상 비교 -->
      <section id="tab-detail" class="tab-pane hidden p-5 overflow-y-auto thin-scroll h-[calc(100vh-136px)]">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
          <div class="bg-white rounded-xl shadow p-4">
            <h2 class="font-semibold mb-2">과정</h2>
            <textarea id="process" class="w-full min-h-40 rounded border p-3 text-sm" placeholder="이전 진행 사항 / 오늘 수정·시도 / 새롭게 알게 된 점 / 문제 & 해결"></textarea>
          </div>

          <div class="bg-white rounded-xl shadow p-4">
            <h2 class="font-semibold mb-3">결과·측정</h2>
            <div class="grid grid-cols-2 gap-3 text-sm">
              <label class="space-y-1"><span class="text-slate-600">EV</span><input id="metricEV" type="number" step="0.01" class="w-full rounded border p-2"/></label>
              <label class="space-y-1"><span class="text-slate-600">SNR</span><input id="metricSNR" type="number" step="0.1" class="w-full rounded border p-2"/></label>
              <label class="space-y-1"><span class="text-slate-600">ΔCCT</span><input id="metricCCT" type="number" step="1" class="w-full rounded border p-2"/></label>
              <label class="space-y-1"><span class="text-slate-600">ΔTint</span><input id="metricTint" type="number" step="0.1" class="w-full rounded border p-2"/></label>
              <label class="space-y-1"><span class="text-slate-600">MTF50</span><input id="metricMTF" type="number" step="0.1" class="w-full rounded border p-2"/></label>
              <label class="space-y-1"><span class="text-slate-600">ISO</span><input id="metricISO" type="number" class="w-full rounded border p-2"/></label>
              <label class="space-y-1"><span class="text-slate-600">셔터</span><input id="metricShutter" type="text" class="w-full rounded border p-2" placeholder="예: 1/100 또는 180°"/></label>
              <label class="space-y-1"><span class="text-slate-600">조리개</span><input id="metricAperture" type="text" class="w-full rounded border p-2" placeholder="예: F4.0"/></label>
              <label class="space-y-1 md:col-span-2"><span class="text-slate-600">감마/픽처 프로파일</span><input id="metricGamma" type="text" class="w-full rounded border p-2" placeholder="예: S‑Cinetone, S‑Log3 등"/></label>
              <label class="space-y-1 md:col-span-2"><span class="text-slate-600">사용 LUT</span><input id="metricLUT" type="text" class="w-full rounded border p-2" placeholder="예: 709 LUT v2"/></label>
            </div>
            <div class="mt-3 space-y-3">
              <textarea id="resultSummary" class="w-full min-h-24 rounded border p-3 text-sm" placeholder="결과 요약"></textarea>
              <textarea id="nextActions" class="w-full min-h-20 rounded border p-3 text-sm" placeholder="다음 액션"></textarea>
            </div>
          </div>

          <div class="bg-white rounded-xl shadow p-4 lg:col-span-2">
            <div class="flex items-center justify-between mb-3">
              <h2 class="font-semibold">캡처</h2>
              <div class="flex items-center gap-2">
                <label class="cursor-pointer text-sm px-3 py-2 rounded bg-blue-600 text-white hover:bg-blue-700">
                  이미지 추가
                  <input id="imgInput" type="file" accept="image/*" multiple class="hidden">
                </label>
                <button id="captureFromVideo" class="text-sm px-3 py-2 rounded bg-emerald-600 text-white hover:bg-emerald-700">영상 프레임 캡처</button>
              </div>
            </div>
            <div id="imgGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"></div>
          </div>

          <div class="bg-white rounded-xl shadow p-4 lg:col-span-2">
            <h2 class="font-semibold mb-3">영상 비교</h2>
            <div class="grid grid-cols-1 xl:grid-cols-2 gap-4">
              <div class="space-y-2">
                <div class="flex items-center justify-between">
                  <span class="font-medium">영상 A</span>
                  <label class="cursor-pointer text-xs px-2 py-1 rounded bg-slate-700 text-white hover:bg-slate-800">파일 선택
                    <input id="vidAInput" type="file" accept="video/*" class="hidden">
                  </label>
                </div>
                <video id="vidA" class="w-full rounded-lg bg-black" controls></video>
                <div class="text-xs text-slate-500" id="vidAName"></div>
                <label class="text-xs text-slate-600">오프셋(초)
                  <input id="vidAOffset" type="number" step="0.1" value="0" class="ml-2 w-24 rounded border p-1">
                </label>
              </div>
              <div class="space-y-2">
                <div class="flex items-center justify-between">
                  <span class="font-medium">영상 B</span>
                  <label class="cursor-pointer text-xs px-2 py-1 rounded bg-slate-700 text-white hover:bg-slate-800">파일 선택
                    <input id="vidBInput" type="file" accept="video/*" class="hidden">
                  </label>
                </div>
                <video id="vidB" class="w-full rounded-lg bg-black" controls></video>
                <div class="text-xs text-slate-500" id="vidBName"></div>
                <label class="text-xs text-slate-600">오프셋(초)
                  <input id="vidBOffset" type="number" step="0.1" value="0" class="ml-2 w-24 rounded border p-1">
                </label>
              </div>
            </div>
            <div class="mt-4 space-y-3">
              <div class="flex flex-wrap items-center gap-3 text-sm">
                <label><input id="syncPlay" type="checkbox" class="mr-1">동기 재생</label>
                <label><input id="linkTime" type="checkbox" class="mr-1">타임라인 연동</label>
                <label>재생 속도
                  <select id="playbackRate" class="ml-2 border rounded p-1">
                    <option value="0.5">0.5x</option>
                    <option value="0.75">0.75x</option>
                    <option value="1" selected>1x</option>
                    <option value="1.25">1.25x</option>
                    <option value="1.5">1.5x</option>
                    <option value="2">2x</option>
                  </select>
                </label>
                <button id="abToggle" class="px-3 py-1.5 rounded bg-blue-600 text-white">A/B 토글 (Tab)</button>
                <button id="snapCurrent" class="px-3 py-1.5 rounded bg-emerald-600 text-white">현재 프레임 캡처→이미지</button>
              </div>
              <div class="flex items-center gap-3">
                <input id="masterTime" type="range" min="0" max="100" value="0" class="flex-1">
                <span id="masterTimeLabel" class="text-xs text-slate-600 w-28 text-right">0s</span>
              </div>
              <p class="text-xs text-slate-500">동기 규칙: 마스터 슬라이더 시간 + 각 영상 오프셋(초) = 해당 영상의 실제 재생 시각</p>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // (JS 코드는 동일, JSON 내보내기/가져오기 관련 부분만 제거)
  </script>
</body>
</html>
